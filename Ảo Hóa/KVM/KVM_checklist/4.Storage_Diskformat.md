### 1. CÆ¡ cháº¿ lÆ°u trá»¯ Thin Provisioning vs Thick Provisioning trong KVM
#### Thick Provisioning (Pre-allocated)
- Äáº·c Ä‘iá»ƒm:  
  - File disk Ä‘Æ°á»£c cáº¥p phÃ¡t toÃ n bá»™ dung lÆ°á»£ng ngay khi táº¡o, dÃ¹ chÆ°a sá»­ dá»¥ng háº¿t.  
  - VD: Táº¡o 1 disk 50GB â†’ File chiáº¿m ngay 50GB trÃªn host.  
- Æ¯u Ä‘iá»ƒm:  
  - Hiá»‡u suáº¥t cao (khÃ´ng cáº§n má»Ÿ rá»™ng khi ghi dá»¯ liá»‡u).  
  - PhÃ¹ há»£p cho á»©ng dá»¥ng cáº§n I/O á»•n Ä‘á»‹nh (VD: database).  
- NhÆ°á»£c Ä‘iá»ƒm:  
  - LÃ£ng phÃ­ dung lÆ°á»£ng náº¿u khÃ´ng sá»­ dá»¥ng háº¿t.  

#### Thin Provisioning (Sparse)
- Äáº·c Ä‘iá»ƒm:  
  - File disk chá»‰ chiáº¿m dung lÆ°á»£ng thá»±c táº¿ Ä‘Ã£ sá»­ dá»¥ng, má»Ÿ rá»™ng khi cáº§n.  
  - VD: Táº¡o 1 disk 50GB nhÆ°ng má»›i dÃ¹ng 10GB â†’ File chá»‰ chiáº¿m 10GB.  
- Æ¯u Ä‘iá»ƒm:  
  - Tiáº¿t kiá»‡m dung lÆ°á»£ng lÆ°u trá»¯.  
  - Dá»… dÃ ng má»Ÿ rá»™ng (resize).  
- NhÆ°á»£c Ä‘iá»ƒm:  
  - Hiá»‡u suáº¥t tháº¥p hÆ¡n do pháº£i cáº¥p phÃ¡t Ä‘á»™ng.  
  - Cáº§n theo dÃµi Ä‘á»ƒ trÃ¡nh háº¿t dung lÆ°á»£ng Ä‘á»™t ngá»™t.  

> ðŸ’¡ Lá»‡nh kiá»ƒm tra dung lÆ°á»£ng thá»±c táº¿:  
>
> du -h <tÃªn-file-disk>  # Hiá»ƒn thá»‹ dung lÆ°á»£ng thá»±c chiáº¿m trÃªn host
> 
---

### 2. PhÃ¢n biá»‡t 3 Ä‘á»‹nh dáº¡ng disk trong KVM: ISO, RAW, QCOW2
| Äá»‹nh dáº¡ng | Má»¥c Ä‘Ã­ch                  | Äáº·c Ä‘iá»ƒm                                                                 |
|--------------|-------------------------------|-----------------------------------------------------------------------------|
| ISO      | File áº£nh Ä‘Ä©a CD/DVD           | DÃ¹ng Ä‘á»ƒ cÃ i OS hoáº·c pháº§n má»m tá»« á»• Ä‘Ä©a áº£o. KhÃ´ng thá»ƒ ghi dá»¯ liá»‡u má»›i (read-only). |
| RAW      | Disk áº£o khÃ´ng nÃ©n             | Dung lÆ°á»£ng cá»‘ Ä‘á»‹nh, hiá»‡u suáº¥t cao, khÃ´ng há»— trá»£ snapshot.                   |
| QCOW2    | Disk áº£o nÃ©n (Copy-On-Write)   | Há»— trá»£ snapshot, nÃ©n dá»¯ liá»‡u, dung lÆ°á»£ng má»Ÿ rá»™ng Ä‘á»™ng (thin provisioning).  |

---

### 3. TÃ­nh nÄƒng vÃ  á»©ng dá»¥ng cá»§a tá»«ng Ä‘á»‹nh dáº¡ng
#### â‘  ISO
- TÃ­nh nÄƒng:  
  - Chá»‰ Ä‘á»c (read-only), thÆ°á»ng dÃ¹ng Ä‘á»ƒ boot VM.  
- á»¨ng dá»¥ng:  
  - CÃ i Ä‘áº·t OS (VD: Ubuntu.iso, Windows.iso).  
  - Mount lÃ m á»• Ä‘Ä©a CDROM áº£o.  

#### â‘¡ RAW
- TÃ­nh nÄƒng:  
  - Dung lÆ°á»£ng cá»‘ Ä‘á»‹nh (thick provisioning).  
  - Hiá»‡u suáº¥t gáº§n báº±ng disk váº­t lÃ½.  
- á»¨ng dá»¥ng:  
  - á»” Ä‘Ä©a há»‡ thá»‘ng (VD: /dev/sda).  
  - á»¨ng dá»¥ng cáº§n I/O cao (database, Kubernetes).  

#### â‘¢ QCOW2 (QEMU Copy-On-Write)
- TÃ­nh nÄƒng:  
  - Há»— trá»£ snapshot, nÃ©n dá»¯ liá»‡u, mÃ£ hÃ³a.  
  - Dung lÆ°á»£ng Ä‘á»™ng (thin provisioning).  
- á»¨ng dá»¥ng:  
  - Disk linh hoáº¡t cho VM (VD: root disk cá»§a Cloud VM).  
  - PhÃ¡t triá»ƒn pháº§n má»m (dá»… rollback báº±ng snapshot).  

---

### 4. So sÃ¡nh RAW vs QCOW2
| TiÃªu chÃ­    | RAW                        | QCOW2                      |
|----------------|-------------------------------|--------------------------------|
| Dung lÆ°á»£ng | Chiáº¿m Ä‘á»§ dung lÆ°á»£ng ngay khi táº¡o | Chá»‰ chiáº¿m dung lÆ°á»£ng Ä‘Ã£ dÃ¹ng (tiáº¿t kiá»‡m) |
| Hiá»‡u nÄƒng  | Tá»‘t nháº¥t (gáº§n native)         | Cháº­m hÆ¡n RAW do overhead COW   |
| Snapshot   | KhÃ´ng há»— trá»£                  | Há»— trá»£ snapshot (dá»… backup)    |
| Má»Ÿ rá»™ng    | KhÃ³ (pháº£i resize thá»§ cÃ´ng)     | Dá»… dÃ ng (qemu-img resize)      |
| Báº£o máº­t    | KhÃ´ng mÃ£ hÃ³a                  | Há»— trá»£ mÃ£ hÃ³a (AES)            |

---

### 5. CÃ¡ch chuyá»ƒn Ä‘á»•i giá»¯a RAW vÃ  QCOW2
#### Chuyá»ƒn RAW â†’ QCOW2
qemu-img convert -f raw -O qcow2 disk.raw disk.qcow2
- Giáº£i thÃ­ch:  
  - -f raw: Äá»‹nh dáº¡ng Ä‘áº§u vÃ o.  
  - -O qcow2: Äá»‹nh dáº¡ng Ä‘áº§u ra.  

#### Chuyá»ƒn QCOW2 â†’ RAW

    qemu-img convert -f qcow2 -O raw disk.qcow2 disk.raw

#### Kiá»ƒm tra thÃ´ng tin disk

    qemu-img info disk.qcow2

Output máº«u:

  + file format: qcow2
  + virtual size: 10G (10737418240 bytes)
  + disk size: 2.5G  # Dung lÆ°á»£ng thá»±c chiáº¿m trÃªn host
---

### TÃ³m táº¯t
- Thick Provisioning: Tá»‘t cho hiá»‡u nÄƒng, nhÆ°ng lÃ£ng phÃ­ dung lÆ°á»£ng.  
- Thin Provisioning: Tiáº¿t kiá»‡m dung lÆ°á»£ng, phÃ¹ há»£p cho cloud.  
- RAW: Hiá»‡u suáº¥t cao, khÃ´ng snapshot.  
- QCOW2: Há»— trá»£ snapshot, nÃ©n dá»¯ liá»‡u, phÃ¹ há»£p cho VM linh hoáº¡t.  
- Chuyá»ƒn Ä‘á»•i Ä‘á»‹nh dáº¡ng: DÃ¹ng qemu-img convert.

> ðŸ’¡ Lá»±a chá»n tá»‘i Æ°u:  
> - DÃ¹ng QCOW2 cho háº§u háº¿t VM (vÃ¬ tÃ­nh linh hoáº¡t).  
> - DÃ¹ng RAW náº¿u cáº§n hiá»‡u suáº¥t tá»‘i Ä‘a (VD: database).