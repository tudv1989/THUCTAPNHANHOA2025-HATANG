### 1. Cơ bản về file XML trong KVM
File XML là file cấu hình quan trọng nhất của máy ảo (VM) và mạng ảo (network) trong KVM. Nó định nghĩa toàn bộ thông số phần cứng, kết nối mạng, storage, và các thiết lập khác.

#### Cấu trúc file XML của máy ảo
<domain type='kvm'>  <!-- Loại ảo hóa -->
  <name>ubuntu-vm</name>  <!-- Tên VM -->
  <memory unit='GiB'>4</memory>  <!-- RAM -->
  <vcpu>2</vcpu>  <!-- Số CPU ảo -->
  <os>
    <type arch='x86_64'>hvm</type>  <!-- Kiểu OS -->
    <boot dev='hd'/>  <!-- Boot từ disk -->
  </os>
  <devices>
    <disk type='file' device='disk'>  <!-- Ổ đĩa ảo -->
      <source file='/var/lib/libvirt/images/ubuntu.qcow2'/>
    </disk>
    <interface type='network'>  <!-- Card mạng -->
      <source network='default'/>  <!-- Dùng network 'default' -->
    </interface>
  </devices>
</domain>
#### Cấu trúc file XML của network
<network>
  <name>my-network</name>  <!-- Tên mạng -->
  <forward mode='nat'/>  <!-- Chế độ NAT -->
  <ip address='192.168.100.1' netmask='255.255.255.0'>  <!-- IP dải mạng -->
    <dhcp>  <!-- Cấu hình DHCP -->
      <range start='192.168.100.100' end='192.168.100.200'/>
    </dhcp>
  </ip>
</network>
---

### 2. Tạo máy ảo bằng file XML
#### **Bước 1: Tạo file XML (ví dụ ubuntu-vm.xml)**
<domain type='kvm'>
  <name>ubuntu-vm</name>
  <memory unit='GiB'>4</memory>
  <vcpu>2</vcpu>
  <os>
    <type arch='x86_64'>hvm</type>
    <boot dev='hd'/>
  </os>
  <devices>
    <disk type='file' device='disk'>
      <source file='/var/lib/libvirt/images/ubuntu.qcow2'/>
    </disk>
    <interface type='network'>
      <source network='default'/>
    </interface>
  </devices>
</domain>
#Bước 2: Tạo VM từ file XMLML**
virsh define ubuntu-vm.xml  # Đăng ký VM
virsh start ubuntu-vm       # Khởi động VM
virsh list --all           # Kiểm tra trạng thái
---

3. Tạo network mới bằng file XMLML**
#### **Bước 1: Tạo file XML (ví dụ my-network.xml)**
<network>
  <name>my-network</name>
  <forward mode='nat'/>
  <ip address='192.168.100.1' netmask='255.255.255.0'>
    <dhcp>
      <range start='192.168.100.100' end='192.168.100.200'/>
    </dhcp>
  </ip>
</network>
#### **Bước 2: Tạo network từ file XML**
virsh net-define my-network.xml  # Đăng ký network
virsh net-start my-network       # Kích hoạt network
virsh net-list --all            # Kiểm tra danh sách mạng
---

### **4. Chỉnh sửa cấu hình VM bằng Cách 1: Sử dụng virsh editụng virsh edit**
virsh edit ubuntu-vm  # Mở file XML trong trình soạn thảo (vi/nano)
- **Ví dụ sửa RAM từ 4GB → 8GB**:
 
  <memory unit='GiB'>8</memory>
  
- **Lưu và thoát**: VM sẽ tự động áp dụng thay đổCách 2: Chỉnh sửa trực tiếp file XMLsửa trực tiếp file XML**
sudo nano /etc/libvirt/qemu/ubuntu-vm.xml  # Mở file bằng nano
virsh define /etc/libvirt/qemu/ubuntu-vm.xml  # Cập nhật thay đổi
#### Thông sốổi phổ biVí dụ thay đổi*       | **Ví dụ thay Lưu ý                 | **Lưu ý**                     |
|--------------------|---------------------------------------|-------CPU-----------------|
| **CPU**            | <vcpu>4</vcpu>                      | Cần shRAMVM.              |
| **RAM**            | <memory unit='GiB'>8</memory>       | Áp dụnDiskboot.           |
| **Disk**           | <source file='/path/to/new-disk.qcow2'/> | Kiểm Networkẫn.          |
| **Network**        | <source network='my-network'/>      | NetworBoot order.         |
| **Boot order**     | <boot dev='cdrom'/>                 | Dùng để boot t5. Ví dụ thực tế--

##Thêm CD-ROM để cài OS từ ISOêm CD-ROM để cài OS từ ISO**
<disk type='file' device='cdrom'>
  <source file='/var/lib/libvirt/images/ubuntu.iso'/>
  <target dev='hda' bus='ide'/>
</disk>
#### **Thêm GPU Passthrough**
<hostdev mode='subsystem' type='pci' managed='yes'>
  <source>
    <address domain='0x0000' bus='0x01' slot='0x00' function='0x0'/>
  </source>
</hostdev>