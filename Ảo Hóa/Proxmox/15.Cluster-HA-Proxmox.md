## Lý thuyết

Mình sẽ thực hiện bài LAB 5 node Proxmox tham gia vào cụm Cluster

Sơ đồ mình lên như hình vẽ

Chi tiết như sau:

  <img src="proxmoximages/Screenshot_115.png">

Mỗi Node Proxmox có cấu hình giống nhau để dễ xử lý

IP node 1: 172.16.9.101
IP node 2: 172.16.9.102
IP node 2: 172.16.9.103
IP node 2: 172.16.9.104
IP node 2: 172.16.9.105

Mỗi node có 1 ổ 100G cài OS và 3 ổ 50GB làm Ceph : /dev/sda(100GB) + /dev/sdb + /dev/sdc + /dev/sdd

  <img src="proxmoximages/Screenshot_114.png">

Do làm Lab nên mình chỉ sử dụng 1 mạng 172.16.9.x/20 để test và tạm tắt firewall

Đảm bảo admin các node vào được

https://172.16.9.101-105:8006/

  <img src="proxmoximages/Screenshot_116.png">

## Bước 1: 

Trên máy dự định làm Master của cụm click vào Datacenter > Cluster > Create Cluster

  <img src="proxmoximages/Screenshot_117.png">

  <img src="proxmoximages/Screenshot_118.png">

Click vào Join infomation

  <img src="proxmoximages/Screenshot_119.png">

Copy Join infomation

  <img src="proxmoximages/Screenshot_121.png">

## Bước 2 

Chúng ta sang các node tiếp theo có IP 172.16.9.102-105 làm y đúc như sau:

 Click vào Datacenter > Cluster > Join Cluster

  <img src="proxmoximages/Screenshot_121.png">

Hoàn thành Joine các node vào cụm

  <img src="proxmoximages/Screenshot_122.png">

## Bước 3

Cài Ceph lần lượt các máy, bắt đầu từ máy Master

  <img src="proxmoximages/Screenshot_123.png">

Mình chọn Squid và No-Subscription

  <img src="proxmoximages/Screenshot_124.png">

Yes để máy tự cài

  <img src="proxmoximages/Screenshot_125.png">

  <img src="proxmoximages/Screenshot_126.png">

  <img src="proxmoximages/Screenshot_127.png">

  <img src="proxmoximages/Screenshot_128.png">

  <img src="proxmoximages/Screenshot_129.png">

Cài tương tự các node còn lại phần Ceph

## Bước 4

Cài dịch vụ Monitor Ceph trên tất cả các node còn lại

Click vào máy Proxmox2 > Ceph > Monitor > Create

  <img src="proxmoximages/Screenshot_131.png">

Hoàn thành

  <img src="proxmoximages/Screenshot_132.png">

## Bước 5

Tên các máy lần lượt từ Master 

Chúng ta click vào OSD > Creater OSD

Để mặc định cho nhanh

  <img src="proxmoximages/Screenshot_133.png">

Thao tác với các ổ cứng 50GB đã gắn như ban đầu có đề cập

  <img src="proxmoximages/Screenshot_134.png">

  <img src="proxmoximages/Screenshot_135.png">

Làm tương tự tất cả trên các máy Proxmox còn lại

Hoàn thành create OSD trên cả 5 node:

  <img src="proxmoximages/Screenshot_136.png">

## Bước 6 Create Pool

  <img src="proxmoximages/Screenshot_137.png">

Click vào Proxmox1 Master  > Ceph > Pools > Create Pools

  <img src="proxmoximages/Screenshot_138.png">

  <img src="proxmoximages/Screenshot_139.png">

Sau khi tạo pool xong chúng ta thấy Pool Storage Ceph này đã được kết nối trên tất cả các node

  <img src="proxmoximages/Screenshot_139.png">

  <img src="proxmoximages/Screenshot_140.png">

## Bước 7 Tạo VM ở Pool này.

  <img src="proxmoximages/Screenshot_141.png">

  <img src="proxmoximages/Screenshot_142.png">

  <img src="proxmoximages/Screenshot_143.png">

  <img src="proxmoximages/Screenshot_144.png">






